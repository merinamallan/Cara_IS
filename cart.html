<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cara</title>
    <link rel="icon" type="image/x-icon" href="/img/icon1.png" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <section id="header">
      <a href="#"><img src="img/logo.png" class="logo" alt="" /></a>
      <!-- <div class=""></div> -->
      <div>
        <ul id="navbar">
          <li><a href="index.html">Home</a></li>
          <li><a href="shop.html">Shop</a></li>
          <li><a href="blog.html">Blog</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li id="lg-bag">
            <a class="active" href="cart.html"
              ><i class="bx bx-shopping-bag"></i
            ></a>
          </li>
          <a href="#" id="close"><i class="bx bx-x"></i></a>
        </ul>
      </div>
      <div id="mobile">
        <a href="cart.html"><i class="bx bx-shopping-bag"></i></a>
        <i id="bar" class="bx bx-menu"></i>
      </div>
    </section>

    <section id="page-header" class="about-header">
      <h2>#let's_talk</h2>
      <p>LEAVE A MESSAGE, We love to hear from you!</p>
    </section>

    <section id="cart" class="section-p1">
      <table width="100%">
        <thead>
          <tr>
            <td>Remove</td>
            <td>Image</td>
            <td>Product</td>
            <td>Price</td>
            <td>Quantity</td>
            <td>Subtotal</td>
          </tr>
        </thead>
        <tbody id="cart-items">
          <!-- JavaScript will insert the cart rows here -->
        </tbody>
      </table>
    </section>

    <section id="cart-add" class="section-p1">
      <div id="coupon">
        <h3>Apply Coupon</h3>
        <div>
          <input type="text" placeholder="Enter Your Coupon" />
          <button class="normal">Apply</button>
        </div>
      </div>

      <div id="subtotal">
        <h3>Cart Total</h3>
        <table>
          <tr>
            <td>Cart Subtotal</td>
            <td>â‚¹7399</td>
          </tr>
          <tr>
            <td>Shipping</td>
            <td>Free</td>
          </tr>
          <tr>
            <td><strong>Total</strong></td>
            <td><strong>â‚¹7399</strong></td>
          </tr>
        </table>
        <button id="purchase-btn" class="normal">Purchase</button>
      </div>
    </section>

    <footer class="section-p1">
      <div class="col">
        <img class="logo" src="./img/logo.png" alt="" />
        <h4>Contact</h4>
        <p>
          <strong>Address:</strong> 562 Wellington Road, Street 32, San
          Francisco
        </p>
        <p><strong>Phone:</strong> +01 2222 345 / (+91) 0 123 456 789</p>
        <p><strong>Hours:</strong> 10:00 - 18:00, Mon - Sat</p>
        <div class="follow">
          <h4>Follow us</h4>
          <div class="icon">
            <i class="bx bxl-facebook"></i>
            <i class="bx bxl-twitter"></i>
            <i class="bx bxl-instagram"></i>
            <i class="bx bxl-pinterest-alt"></i>
            <i class="bx bxl-youtube"></i>
          </div>
        </div>
      </div>

      <div class="col">
        <h4>About</h4>
        <a href="#">About us</a>
        <a href="#">Devlivery Information</a>
        <a href="#">Privacy Policy</a>
        <a href="#">Terms & Conditions</a>
        <a href="#">Contact Us</a>
      </div>

      <div class="col">
        <h4>My Account</h4>
        <a href="#">Sign In</a>
        <a href="#">View Cart</a>
        <a href="#">My Wishlist</a>
        <a href="#">Track My Order</a>
        <a href="#">Help</a>
      </div>

      <div class="col install">
        <h4>Install App</h4>
        <p>From App Store or Google Play</p>
        <div class="row">
          <img src="./img/pay/app.jpg" alt="" />
          <img src="./img/pay/play.jpg" alt="" />
        </div>
        <p>Secured Payment Gateways</p>
        <img src="./img/pay/pay.png" alt="" />
      </div>

      <div class="copyright">
        <p>Â© 2023, Sahad cmd - HTML CSS Ecommerce Template</p>
      </div>
    </footer>

    <script src="script.js"></script>

    <script>
      // Get items from localStorage
      let cart = JSON.parse(localStorage.getItem("cartItems")) || [];
      let cartTable = document.getElementById("cart-items");
      cartTable.innerHTML = ""; // Clear rows first

      let subtotal = 0;

      if (cart.length === 0) {
        cartTable.innerHTML = `<tr><td colspan="6">ðŸ›’ Your cart is empty</td></tr>`;
      } else {
        cart.forEach((item, index) => {
          let price = parseFloat(item.price.replace(/[^0-9]/g, "")); // numbers only
          let totalPrice = price * item.quantity;
          subtotal += totalPrice;

          let row = `
        <tr>
          <td><i class="bx bx-x-circle remove-item" data-index="${index}"></i></td>
          <td><img src="${item.image}" width="50"></td>
          <td>${item.name}</td>
          <td>${item.price}</td>
          <td><input type="number" value="${item.quantity}" min="1" class="qty-input" data-index="${index}"></td>
          <td>â‚¹${totalPrice}</td>
        </tr>
      `;
          cartTable.innerHTML += row;
        });
      }

      // Update totals
      if (document.getElementById("subtotal")) {
        document.getElementById("subtotal").innerText = "â‚¹" + subtotal;
      }
      if (document.getElementById("total")) {
        document.getElementById("total").innerText = "â‚¹" + subtotal;
      }

      // ðŸ—‘ Remove item
      document.querySelectorAll(".remove-item").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          let index = e.target.getAttribute("data-index");
          cart.splice(index, 1);
          localStorage.setItem("cartItems", JSON.stringify(cart));
          location.reload(); // refresh page
        });
      });

      // ðŸ”¢ Update quantity
      document.querySelectorAll(".qty-input").forEach((input) => {
        input.addEventListener("change", (e) => {
          let index = e.target.getAttribute("data-index");
          cart[index].quantity = parseInt(e.target.value);
          localStorage.setItem("cartItems", JSON.stringify(cart));
          location.reload();
        });
      });
    </script>
    <script>
      const purchaseBtn = document.getElementById("purchase-btn");
      if (purchaseBtn) {
        purchaseBtn.addEventListener("click", () => {
          let cart = JSON.parse(localStorage.getItem("cartItems")) || [];
          if (cart.length === 0) {
            alert("Your cart is empty. Add some products first.");
          } else {
            alert("âœ… Purchase successful! Thank you for shopping.");
            localStorage.removeItem("cartItems"); // clear cart after purchase
            location.reload(); // refresh cart page
          }
        });
      }
    </script>

    <script>
      window.Evergage = window.Evergage || [];
      window.Evergage.push(function (evergage) {
        "use strict";

        const pathname = window.location.pathname || "";
        let pageName = "Page viewed: " + pathname;
        let pageType = "other";

        if (pathname.includes("cart.html") || pathname === "/cart") {
          pageName = "Cart page viewed";
          pageType = "cart";
        }

        const payload = {
          action: pageName,
          attributes: {
            pageType,
            pathname,
          },
        };

        evergage.sendEvent(payload);
        console.log("Evergage event sent:", payload);
      });
    </script>
  </body>
</html>
